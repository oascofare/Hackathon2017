{"topologyName":"MachineLogAnalytics-v0","config":"{\"topology.workers\":5,\"topology.acker.executors\":1,\"topology.message.timeout.secs\":67,\"clustersSecurityConfig\":[{}],\"topology.worker.childopts\":\"-Xmx3072m\"}","sources":[{"id":1,"topologyId":1,"topologyComponentBundleId":1,"versionId":5,"name":"KAFKA","description":"","config":{"properties":{"cluster":"1","consumerGroupId":"sam_gid","retryDelayPeriodMs":2,"maximumUncommittedOffsets":10000000,"maxRecordsPerPoll":"500","maximumRetries":2147483647,"parallelism":1,"emitNullTuples":false,"partitionRefreshPeriodMs":2000,"securityProtocol":"PLAINTEXT","bootstrapServers":"zhoussenhdf30envt-1190-1-0.example.com:6667","kafkaServiceName":"","retryDelayMaximumMs":10000,"fetchMaximumBytesPerPartition":"1048576","firstPollOffsetStrategy":"UNCOMMITTED_EARLIEST","sslTruststoreType":"JKS","clusters":"zhoussenhdf30envt","fetchMinimumBytes":"1","consumerStartupDelayMs":60000,"sslKeystoreType":"JKS","sslTrustManagerAlgo":"PKIX","retryInitialDelayMs":0,"sslKeyManagerAlgo":"SunX509","sslProtocol":"TLS","topic":"syslog_pam_avro","pollTimeoutMs":200,"offsetCommitPeriodMs":30000}},"outputStreams":[{"id":1,"versionId":5,"streamId":"kafka_stream_1","description":null,"topologyId":1,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1507238880509}],"timestamp":1507238880277}],"sinks":[{"id":7,"topologyId":1,"topologyComponentBundleId":10,"versionId":5,"name":"HDFS-AllEvents","description":"","config":{"properties":{"fsUrl":"hdfs://172.26.232.221:8020","outputFields":["EventId","timestamp","shostname","SessionUser","SessionByUser","SessionEvent"],"cluster":"1","path":"/tmp/rsyslogs","extension":".txt","rotationPolicy":{"timeBasedRotation":{"rotationInterval":5,"rotationIntervalUnit":"MINUTES"}},"prefix":"","parallelism":1,"countPolicyValue":60,"clusters":"zhoussenhdf30envt"}},"timestamp":1507238880509},{"id":2,"topologyId":1,"topologyComponentBundleId":16,"versionId":5,"name":"DRUID","description":"","config":{"properties":{"cluster":"1","clusterReplication":1,"segmentGranularity":"TEN_MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":2000,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[],"tranquilityZKconnect":"zhoussenhdf30envt-1190-1-0.example.com:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":0,"queryGranularity":"MINUTE","dataSource":"syslog-events","clusters":"zhoussenhdf30envt","dimensions":["EventId","timestamp","shostname","SessionUser","SessionByUser","SessionEvent"]}},"timestamp":1507238880509},{"id":8,"topologyId":1,"topologyComponentBundleId":10,"versionId":5,"name":"HDFS-AggEvents","description":"","config":{"properties":{"fsUrl":"hdfs://172.26.232.221:8020","outputFields":["shostname","SessionByUser","SessionUser","SumNumFailures"],"cluster":"1","path":"/tmp/rsyslogs-agg","extension":".txt","rotationPolicy":{"sizeBasedRotation":{"rotationSize":4,"rotationSizeUnit":"KB"}},"prefix":"","parallelism":1,"countPolicyValue":30,"clusters":"zhoussenhdf30envt"}},"timestamp":1507238880509},{"id":6,"topologyId":1,"topologyComponentBundleId":12,"versionId":5,"name":"NotifyEmail","description":"","config":{"properties":{"notifierName":"Email Notifier","parallelism":1,"className":"com.hortonworks.streamline.streams.notifiers.EmailNotifier","fieldValues":{"contentType":"text/plain","from":"sam@hortonworks.com","to":"teamcanadahwx@gmail.com","subject":"Account Penetration Alert on ${shostname}","body":"${SessionUser} has had ${SumNumFailures} occurrences of authentication failure events on hostname ${shostname}. \n\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam"},"notificationStoreClassName":"","jarFileName":"notifiers-477b85e6-a898-48d4-8c26-cc1f83b9112f.jar","properties":{"ssl":false,"starttls":true,"debug":true,"protocol":"smtp","auth":true,"username":"teamcanadahwx@gmail.com","password":"hadoopisgood","host":"smtp.gmail.com","port":587}}},"timestamp":1507238880509}],"processors":[{"id":3,"topologyId":1,"topologyComponentBundleId":4,"versionId":5,"name":"FilterAuthFailureEvents","description":"","config":{"properties":{"rules":[2],"parallelism":3}},"outputStreams":[{"id":4,"versionId":5,"streamId":"rule_transform_stream_2","description":null,"topologyId":1,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1507238880509},{"id":5,"versionId":5,"streamId":"rule_notifier_stream_2","description":null,"topologyId":1,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1507238880509}],"timestamp":1507238880509},{"id":4,"topologyId":1,"topologyComponentBundleId":5,"versionId":5,"name":"AggNumFailureEvents","description":"","config":{"properties":{"rules":[1],"parallelism":1}},"outputStreams":[{"id":6,"versionId":5,"streamId":"window_transform_stream_4","description":null,"topologyId":1,"fields":[{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumNumFailures","type":"LONG","optional":false}],"timestamp":1507238880509},{"id":7,"versionId":5,"streamId":"window_notifier_stream_4","description":null,"topologyId":1,"fields":[{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumNumFailures","type":"LONG","optional":false}],"timestamp":1507238880509}],"timestamp":1507238880509},{"id":5,"topologyId":1,"topologyComponentBundleId":4,"versionId":5,"name":"DetectSuspiscionThreshold","description":"","config":{"properties":{"rules":[3]}},"outputStreams":[{"id":8,"versionId":5,"streamId":"rule_transform_stream_3","description":null,"topologyId":1,"fields":[{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumNumFailures","type":"LONG","optional":false}],"timestamp":1507238880509},{"id":9,"versionId":5,"streamId":"rule_notifier_stream_3","description":null,"topologyId":1,"fields":[{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumNumFailures","type":"LONG","optional":false}],"timestamp":1507238880509}],"timestamp":1507238880509}],"edges":[{"id":1,"versionId":5,"topologyId":1,"fromId":1,"toId":2,"streamGroupings":[{"streamId":1,"grouping":"SHUFFLE","fields":null}],"timestamp":1507238880509},{"id":2,"versionId":5,"topologyId":1,"fromId":1,"toId":3,"streamGroupings":[{"streamId":1,"grouping":"SHUFFLE","fields":null}],"timestamp":1507238880509},{"id":6,"versionId":5,"topologyId":1,"fromId":1,"toId":7,"streamGroupings":[{"streamId":1,"grouping":"SHUFFLE","fields":null}],"timestamp":1507238880509},{"id":3,"versionId":5,"topologyId":1,"fromId":3,"toId":4,"streamGroupings":[{"streamId":4,"grouping":"FIELDS","fields":["shostname","SessionByUser","SessionUser"]}],"timestamp":1507238880509},{"id":4,"versionId":5,"topologyId":1,"fromId":4,"toId":5,"streamGroupings":[{"streamId":6,"grouping":"SHUFFLE","fields":null}],"timestamp":1507238880509},{"id":7,"versionId":5,"topologyId":1,"fromId":4,"toId":8,"streamGroupings":[{"streamId":6,"grouping":"SHUFFLE","fields":null}],"timestamp":1507238880509},{"id":5,"versionId":5,"topologyId":1,"fromId":5,"toId":6,"streamGroupings":[{"streamId":9,"grouping":"SHUFFLE","fields":null}],"timestamp":1507238880509}],"rules":[{"id":2,"versionId":5,"topologyId":1,"name":"FilterAuthFailureEvents","description":"Filter Authentication Failure Events","streams":["kafka_stream_1"],"condition":"SessionEvent = 'failure'","sql":"SELECT *  FROM kafka_stream_1 WHERE SessionEvent = 'failure'","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_2"],"transforms":[]}],"outputStreams":["rule_transform_stream_2","rule_notifier_stream_2"],"timestamp":1507238880509},{"id":3,"versionId":5,"topologyId":1,"name":"AlertThreshold","description":"Set Alert threshold for more than 3 failures in 30 seconds","streams":["window_transform_stream_4"],"condition":"SumNumFailures > 3","sql":"SELECT *  FROM window_transform_stream_4 WHERE SumNumFailures > 3","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.NotifierAction","name":"notifierAction","outputStreams":["rule_notifier_stream_3"],"notifierName":"Email Notifier","outputFieldsAndDefaults":{"from":"sam@hortonworks.com","to":"teamcanadahwx@gmail.com","body":"${SessionUser} has had ${SumNumFailures} occurrences of authentication failure events on hostname ${shostname}. \n\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam","contentType":"text/plain","subject":"Account Penetration Alert on ${shostname}"}}],"outputStreams":["rule_transform_stream_3","rule_notifier_stream_3"],"timestamp":1507238880509}],"windows":[{"id":1,"versionId":5,"topologyId":1,"name":"window_auto_generated","description":"window description auto generated","streams":["rule_transform_stream_2"],"window":{"windowLength":{"class":".Window$Duration","durationMs":30000},"slidingInterval":{"class":".Window$Duration","durationMs":30000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_4"],"transforms":[]}],"projections":[{"functionName":"LONGCOUNT","args":["EventId"],"outputFieldName":"SumNumFailures"},{"expr":"shostname"},{"expr":"SessionByUser"},{"expr":"SessionUser"}],"groupbykeys":["shostname","SessionByUser","SessionUser"],"outputStreams":["window_transform_stream_4","window_notifier_stream_4"],"timestamp":1507238880509}],"branchRules":[],"bundleIdToType":{"1":"KAFKA","12":"NOTIFICATION","4":"RULE","16":"DRUID","5":"WINDOW","10":"HDFS"},"topologyEditorMetadata":{"topologyId":1,"versionId":5,"data":"{\"sources\":[{\"x\":238.75,\"y\":165.75,\"id\":1}],\"processors\":[{\"x\":576.1396484375,\"y\":166.18289184570312,\"id\":3},{\"x\":905.1015014648438,\"y\":166.18289184570312,\"id\":4},{\"x\":1176.9605712890625,\"y\":164.9415283203125,\"id\":5}],\"sinks\":[{\"x\":576.1396484375,\"y\":64.39092254638672,\"id\":2},{\"x\":1483.577880859375,\"y\":164.9415283203125,\"id\":6},{\"x\":579.86376953125,\"y\":259.2853088378906,\"id\":7},{\"x\":1179.443359375,\"y\":253.07846069335938,\"id\":8}],\"graphTransforms\":{\"dragCoords\":[46.478892463132524,4.017668233835025],\"zoomScale\":0.8055644400453753}}","timestamp":1507238880258}}