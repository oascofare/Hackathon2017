{"topologyName":"MachineLogAnalyticsDemo","config":"{\"topology.workers\":6,\"topology.acker.executors\":1,\"topology.message.timeout.secs\":607,\"clustersSecurityConfig\":[{}],\"topology.worker.childopts\":\"-Xmx3072m\"}","sources":[{"id":172,"topologyId":20,"topologyComponentBundleId":1,"versionId":44,"name":"KAFKA","description":"","config":{"properties":{"cluster":"1","consumerGroupId":"sam_gid","retryDelayPeriodMs":2,"maximumUncommittedOffsets":10000000,"maxRecordsPerPoll":"500","maximumRetries":2147483647,"parallelism":1,"emitNullTuples":false,"partitionRefreshPeriodMs":2000,"securityProtocol":"PLAINTEXT","bootstrapServers":"secanhdf30demo-1167-1-0.example.com:6667","kafkaServiceName":"","retryDelayMaximumMs":10000,"fetchMaximumBytesPerPartition":"1048576","firstPollOffsetStrategy":"UNCOMMITTED_EARLIEST","sslTruststoreType":"JKS","clusters":"secanhdf30demo","fetchMinimumBytes":"1","consumerStartupDelayMs":60000,"sslKeystoreType":"JKS","sslTrustManagerAlgo":"PKIX","retryInitialDelayMs":0,"sslKeyManagerAlgo":"SunX509","sslProtocol":"TLS","topic":"machine_log_syslog_pam_avro","pollTimeoutMs":200,"offsetCommitPeriodMs":30000}},"outputStreams":[{"id":173,"versionId":44,"streamId":"kafka_stream_69","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292}],"timestamp":1509031669479}],"sinks":[{"id":182,"topologyId":20,"topologyComponentBundleId":16,"versionId":44,"name":"DRUID-MachineLogsDSN","description":"","config":{"properties":{"cluster":"1","clusterReplication":1,"segmentGranularity":"MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":2000,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[],"tranquilityZKconnect":"secanhdf30demo-1167-1-0.example.com:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":0,"queryGranularity":"MINUTE","dataSource":"machinelogs-dsn","clusters":"secanhdf30demo","dimensions":["EventId","timestamp_ux","event_month","event_day","event_dow","event_hour","shostname","SessionUser","SessionByUser","SessionEvent"]}},"timestamp":1509031670292},{"id":181,"topologyId":20,"topologyComponentBundleId":10,"versionId":44,"name":"HDFS-OpenSessions","description":"","config":{"properties":{"fsUrl":"hdfs://172.26.230.143:8020","outputFields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser","SumOpenSessionEvents"],"cluster":"1","path":"/tmp/rsyslogs-opened-glr","extension":".txt","rotationPolicy":{"sizeBasedRotation":{"rotationSize":10,"rotationSizeUnit":"KB"}},"prefix":"","parallelism":1,"countPolicyValue":30,"clusters":"secanhdf30demo"}},"timestamp":1509031670292},{"id":196,"topologyId":20,"topologyComponentBundleId":16,"versionId":44,"name":"DRUID-OpenSessionsDSN","description":"","config":{"properties":{"cluster":"1","clusterReplication":1,"segmentGranularity":"FIVE_MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":2000,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[],"tranquilityZKconnect":"secanhdf30demo-1167-1-0.example.com:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":0,"queryGranularity":"MINUTE","dataSource":"closedsessions-dsn","clusters":"secanhdf30demo","dimensions":["shostname","SessionByUser","SessionUser","SumOpenSessionEvents","AvgOpened"]}},"timestamp":1509031670292},{"id":193,"topologyId":20,"topologyComponentBundleId":12,"versionId":44,"name":"NotifyEmailOpenSessions","description":"","config":{"properties":{"notifierName":"Email Notifier","parallelism":1,"className":"com.hortonworks.streamline.streams.notifiers.EmailNotifier","fieldValues":{"contentType":"text/plain","from":"sam@hortonworks.com","to":"teamcanadahwx@gmail.com","subject":"Suspiscious Activity Alert for user ${SessionUser}","body":"${SessionUser} activity on host ${hostname} seems suspiscious for the number of open sessions. \n\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam"},"notificationStoreClassName":"","jarFileName":"notifiers-f2584f76-bfce-42fa-a92d-db7b6582963b.jar","properties":{"ssl":false,"starttls":true,"debug":true,"protocol":"smtp","auth":true,"username":"sepscanhwx@gmail.com","password":"hadoopisgood","host":"smtp.gmail.com","port":587}}},"timestamp":1509031670292},{"id":180,"topologyId":20,"topologyComponentBundleId":10,"versionId":44,"name":"HDFS-ClosedSessions","description":"","config":{"properties":{"fsUrl":"hdfs://172.26.230.143:8020","outputFields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser","SumClosedSessionEvents"],"cluster":"1","path":"/tmp/rsyslogs-closed-glr","extension":".txt","rotationPolicy":{"sizeBasedRotation":{"rotationSize":10,"rotationSizeUnit":"KB"}},"prefix":"","parallelism":1,"countPolicyValue":60,"clusters":"secanhdf30demo"}},"timestamp":1509031670292},{"id":195,"topologyId":20,"topologyComponentBundleId":16,"versionId":44,"name":"DRUID-ClosedSessionsDSN","description":"","config":{"properties":{"cluster":"1","clusterReplication":1,"segmentGranularity":"FIVE_MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":2000,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[],"tranquilityZKconnect":"secanhdf30demo-1167-1-0.example.com:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":0,"queryGranularity":"MINUTE","dataSource":"closedsessions-dsn","clusters":"secanhdf30demo","dimensions":["shostname","SessionByUser","SessionUser","SumClosedSessionEvents","AvgClosed"]}},"timestamp":1509031670292},{"id":194,"topologyId":20,"topologyComponentBundleId":12,"versionId":44,"name":"NotifyEmailClosedEvents","description":"","config":{"properties":{"notifierName":"Email Notifier","parallelism":1,"className":"com.hortonworks.streamline.streams.notifiers.EmailNotifier","fieldValues":{"contentType":"text/plain","from":"sam@hortonworks.com","to":"teamcanadahwx@gmail.com","subject":"Account Penetration Alert for User ${SessionUser}","body":"${SessionUser} activity on host ${hostname} seems suspiscious for the number of closed sessions. \n\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam"},"notificationStoreClassName":"","jarFileName":"notifiers-f2584f76-bfce-42fa-a92d-db7b6582963b.jar","properties":{"ssl":false,"starttls":true,"debug":true,"protocol":"smtp","auth":true,"username":"sepscanhwx@gmail.com","password":"hadoopisgood","host":"smtp.gmail.com","port":587}}},"timestamp":1509031670292},{"id":185,"topologyId":20,"topologyComponentBundleId":12,"versionId":44,"name":"NotifyEmail-FailureEvents","description":"","config":{"properties":{"notifierName":"Email Notifier","parallelism":1,"className":"com.hortonworks.streamline.streams.notifiers.EmailNotifier","fieldValues":{"contentType":"text/plain","from":"sam@hortonworks.com","to":"secanhwx@gmail.com","subject":"Account Penetration Alert for ${SessionUser}","body":"${SessionUser} has just had ${SumFailureEvents30s} authentication failures on host ${shostname}.\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam"},"notificationStoreClassName":"","jarFileName":"notifiers-f2584f76-bfce-42fa-a92d-db7b6582963b.jar","properties":{"ssl":false,"starttls":true,"debug":true,"protocol":"smtp","auth":true,"username":"secanhwx@gmail.com","password":"hadoopisgood","host":"smtp.gmail.com","port":587}}},"timestamp":1509031670292},{"id":179,"topologyId":20,"topologyComponentBundleId":10,"versionId":44,"name":"HDFS-FailureSessions","description":"","config":{"properties":{"fsUrl":"hdfs://172.26.230.143:8020","outputFields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser","SumAuthFailureEvents"],"cluster":"1","path":"/tmp/rsyslogs-failures","extension":".txt","rotationPolicy":{"sizeBasedRotation":{"rotationSize":10,"rotationSizeUnit":"KB"}},"prefix":"","parallelism":1,"countPolicyValue":60,"clusters":"secanhdf30demo"}},"timestamp":1509031670292}],"processors":[{"id":177,"topologyId":20,"topologyComponentBundleId":4,"versionId":44,"name":"FilterOpenSessionEvents","description":"","config":{"properties":{"rules":[46]}},"outputStreams":[{"id":182,"versionId":44,"streamId":"rule_transform_stream_19","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292},{"id":183,"versionId":44,"streamId":"rule_notifier_stream_19","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":178,"topologyId":20,"topologyComponentBundleId":5,"versionId":44,"name":"AggOpenSessionEvents","description":"","config":{"properties":{"rules":[33],"parallelism":1}},"outputStreams":[{"id":184,"versionId":44,"streamId":"window_transform_stream_73","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumOpenSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":185,"versionId":44,"streamId":"window_notifier_stream_73","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumOpenSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":198,"topologyId":20,"topologyComponentBundleId":8,"versionId":44,"name":"PMML-ScoringOpenSessionEvents","description":"","config":{"properties":{"modelName":"GLR_Opened_4_1","parallelism":1}},"outputStreams":[{"id":196,"versionId":44,"streamId":"pmml_stream_198","description":null,"topologyId":20,"fields":[{"name":"AvgOpened","type":"DOUBLE","optional":false},{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumOpenSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":190,"topologyId":20,"topologyComponentBundleId":4,"versionId":44,"name":"OpenSessionsThresholdDetection","description":"","config":{"properties":{"rules":[49]}},"outputStreams":[{"id":192,"versionId":44,"streamId":"rule_transform_stream_49","description":null,"topologyId":20,"fields":[{"name":"AvgOpened","type":"DOUBLE","optional":false},{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumOpenSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":193,"versionId":44,"streamId":"rule_notifier_stream_49","description":null,"topologyId":20,"fields":[{"name":"AvgOpened","type":"DOUBLE","optional":false},{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumOpenSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":175,"topologyId":20,"topologyComponentBundleId":4,"versionId":44,"name":"FilterClosedSessionEvents","description":"","config":{"properties":{"rules":[45]}},"outputStreams":[{"id":178,"versionId":44,"streamId":"rule_transform_stream_20","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292},{"id":179,"versionId":44,"streamId":"rule_notifier_stream_20","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":176,"topologyId":20,"topologyComponentBundleId":5,"versionId":44,"name":"AggClosedSessionEvents","description":"","config":{"properties":{"rules":[32],"parallelism":1}},"outputStreams":[{"id":180,"versionId":44,"streamId":"window_transform_stream_74","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumClosedSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":181,"versionId":44,"streamId":"window_notifier_stream_74","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumClosedSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":199,"topologyId":20,"topologyComponentBundleId":8,"versionId":44,"name":"PMML-ScoringClosedSessionEvents","description":"","config":{"properties":{"modelName":"GLR_Closed_4_1","parallelism":1}},"outputStreams":[{"id":197,"versionId":44,"streamId":"pmml_stream_199","description":null,"topologyId":20,"fields":[{"name":"AvgClosed","type":"DOUBLE","optional":false},{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumClosedSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":192,"topologyId":20,"topologyComponentBundleId":4,"versionId":44,"name":"ClosedSessionsThresholdDetection","description":"","config":{"properties":{"rules":[50]}},"outputStreams":[{"id":194,"versionId":44,"streamId":"rule_transform_stream_50","description":null,"topologyId":20,"fields":[{"name":"AvgClosed","type":"DOUBLE","optional":false},{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumClosedSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":195,"versionId":44,"streamId":"rule_notifier_stream_50","description":null,"topologyId":20,"fields":[{"name":"AvgClosed","type":"DOUBLE","optional":false},{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumClosedSessionEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":173,"topologyId":20,"topologyComponentBundleId":4,"versionId":44,"name":"FilterAuthFailureEvents","description":"","config":{"properties":{"rules":[44]}},"outputStreams":[{"id":174,"versionId":44,"streamId":"rule_transform_stream_21","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292},{"id":175,"versionId":44,"streamId":"rule_notifier_stream_21","description":null,"topologyId":20,"fields":[{"name":"EventId","type":"STRING","optional":false},{"name":"timestamp_ux","type":"INTEGER","optional":false},{"name":"event_month","type":"INTEGER","optional":true},{"name":"event_day","type":"INTEGER","optional":true},{"name":"event_dow","type":"INTEGER","optional":true},{"name":"event_hour","type":"INTEGER","optional":true},{"name":"shostname","type":"STRING","optional":true},{"name":"SessionUser","type":"STRING","optional":true},{"name":"SessionByUser","type":"STRING","optional":true},{"name":"SessionEvent","type":"STRING","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":183,"topologyId":20,"topologyComponentBundleId":5,"versionId":44,"name":"AggAuthFailures30sWindow","description":"","config":{"properties":{"rules":[34],"parallelism":1}},"outputStreams":[{"id":186,"versionId":44,"streamId":"window_transform_stream_183","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumFailureEvents30s","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":187,"versionId":44,"streamId":"window_notifier_stream_183","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumFailureEvents30s","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":184,"topologyId":20,"topologyComponentBundleId":4,"versionId":44,"name":"AuthFailureThresholdDetection","description":"","config":{"properties":{"rules":[47]}},"outputStreams":[{"id":188,"versionId":44,"streamId":"rule_transform_stream_47","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumFailureEvents30s","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":189,"versionId":44,"streamId":"rule_notifier_stream_47","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumFailureEvents30s","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292},{"id":174,"topologyId":20,"topologyComponentBundleId":5,"versionId":44,"name":"AggAuthFailureEvents","description":"","config":{"properties":{"rules":[31],"parallelism":1}},"outputStreams":[{"id":176,"versionId":44,"streamId":"window_transform_stream_75","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumAuthFailureEvents","type":"LONG","optional":false}],"timestamp":1509031670292},{"id":177,"versionId":44,"streamId":"window_notifier_stream_75","description":null,"topologyId":20,"fields":[{"name":"event_month","type":"INTEGER","optional":false},{"name":"event_dow","type":"INTEGER","optional":false},{"name":"event_day","type":"INTEGER","optional":false},{"name":"event_hour","type":"INTEGER","optional":false},{"name":"shostname","type":"STRING","optional":false},{"name":"SessionByUser","type":"STRING","optional":false},{"name":"SessionUser","type":"STRING","optional":false},{"name":"SumAuthFailureEvents","type":"LONG","optional":false}],"timestamp":1509031670292}],"timestamp":1509031670292}],"edges":[{"id":145,"versionId":44,"topologyId":20,"fromId":172,"toId":177,"streamGroupings":[{"streamId":173,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":146,"versionId":44,"topologyId":20,"fromId":172,"toId":175,"streamGroupings":[{"streamId":173,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":147,"versionId":44,"topologyId":20,"fromId":172,"toId":173,"streamGroupings":[{"streamId":173,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":154,"versionId":44,"topologyId":20,"fromId":172,"toId":182,"streamGroupings":[{"streamId":173,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":152,"versionId":44,"topologyId":20,"fromId":177,"toId":178,"streamGroupings":[{"streamId":182,"grouping":"FIELDS","fields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"]}],"timestamp":1509031670292},{"id":169,"versionId":44,"topologyId":20,"fromId":178,"toId":198,"streamGroupings":[{"streamId":184,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":170,"versionId":44,"topologyId":20,"fromId":198,"toId":190,"streamGroupings":[{"streamId":196,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":171,"versionId":44,"topologyId":20,"fromId":198,"toId":196,"streamGroupings":[{"streamId":196,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":175,"versionId":44,"topologyId":20,"fromId":198,"toId":181,"streamGroupings":[{"streamId":196,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":164,"versionId":44,"topologyId":20,"fromId":190,"toId":193,"streamGroupings":[{"streamId":193,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":150,"versionId":44,"topologyId":20,"fromId":175,"toId":176,"streamGroupings":[{"streamId":178,"grouping":"FIELDS","fields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"]}],"timestamp":1509031670292},{"id":172,"versionId":44,"topologyId":20,"fromId":176,"toId":199,"streamGroupings":[{"streamId":180,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":173,"versionId":44,"topologyId":20,"fromId":199,"toId":192,"streamGroupings":[{"streamId":197,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":174,"versionId":44,"topologyId":20,"fromId":199,"toId":195,"streamGroupings":[{"streamId":197,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":176,"versionId":44,"topologyId":20,"fromId":199,"toId":180,"streamGroupings":[{"streamId":197,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":165,"versionId":44,"topologyId":20,"fromId":192,"toId":194,"streamGroupings":[{"streamId":195,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":148,"versionId":44,"topologyId":20,"fromId":173,"toId":174,"streamGroupings":[{"streamId":174,"grouping":"FIELDS","fields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"]}],"timestamp":1509031670292},{"id":155,"versionId":44,"topologyId":20,"fromId":173,"toId":183,"streamGroupings":[{"streamId":174,"grouping":"FIELDS","fields":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"]}],"timestamp":1509031670292},{"id":156,"versionId":44,"topologyId":20,"fromId":183,"toId":184,"streamGroupings":[{"streamId":186,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":157,"versionId":44,"topologyId":20,"fromId":184,"toId":185,"streamGroupings":[{"streamId":189,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292},{"id":149,"versionId":44,"topologyId":20,"fromId":174,"toId":179,"streamGroupings":[{"streamId":176,"grouping":"SHUFFLE","fields":null}],"timestamp":1509031670292}],"rules":[{"id":46,"versionId":44,"topologyId":20,"name":"FilterOpenSessionEvents","description":"FilterOpenSessionEvents","streams":["kafka_stream_69"],"condition":"SessionEvent = 'opened'","sql":"SELECT *  FROM kafka_stream_69 WHERE SessionEvent = 'opened'","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_19"],"transforms":[]}],"outputStreams":["rule_transform_stream_19","rule_notifier_stream_19"],"timestamp":1509031670292},{"id":49,"versionId":44,"topologyId":20,"name":"OpenSessionsThresholdDetection","description":"Detect if the actual number of open sessions exceeds the prediction","streams":["pmml_stream_198"],"condition":"SumOpenSessionEvents > AvgOpened","sql":"SELECT *  FROM pmml_stream_198 WHERE SumOpenSessionEvents > AvgOpened","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.NotifierAction","name":"notifierAction","outputStreams":["rule_notifier_stream_49"],"notifierName":"Email Notifier","outputFieldsAndDefaults":{"from":"sam@hortonworks.com","to":"teamcanadahwx@gmail.com","body":"${SessionUser} activity on host ${hostname} seems suspiscious for the number of open sessions. \n\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam","contentType":"text/plain","subject":"Suspiscious Activity Alert for user ${SessionUser}"}}],"outputStreams":["rule_transform_stream_49","rule_notifier_stream_49"],"timestamp":1509031670292},{"id":45,"versionId":44,"topologyId":20,"name":"FilterClosedSessionEvents","description":"Filter Closed Session Events","streams":["kafka_stream_69"],"condition":"SessionEvent = 'closed'","sql":"SELECT *  FROM kafka_stream_69 WHERE SessionEvent = 'closed'","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_20"],"transforms":[]}],"outputStreams":["rule_transform_stream_20","rule_notifier_stream_20"],"timestamp":1509031670292},{"id":50,"versionId":44,"topologyId":20,"name":"ClosedSessionsThresholdDetection","description":"Detect if the actual number of closed sessions exceeds the predicted value","streams":["pmml_stream_199"],"condition":"SumClosedSessionEvents > AvgClosed","sql":"SELECT *  FROM pmml_stream_199 WHERE SumClosedSessionEvents > AvgClosed","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.NotifierAction","name":"notifierAction","outputStreams":["rule_notifier_stream_50"],"notifierName":"Email Notifier","outputFieldsAndDefaults":{"from":"sam@hortonworks.com","to":"teamcanadahwx@gmail.com","body":"${SessionUser} activity on host ${hostname} seems suspiscious for the number of closed sessions. \n\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam","contentType":"text/plain","subject":"Account Penetration Alert for User ${SessionUser}"}}],"outputStreams":["rule_transform_stream_50","rule_notifier_stream_50"],"timestamp":1509031670292},{"id":44,"versionId":44,"topologyId":20,"name":"FilterAuthFailureEvents","description":"Filter Authentication Failure Events","streams":["kafka_stream_69"],"condition":"SessionEvent = 'failure'","sql":"SELECT *  FROM kafka_stream_69 WHERE SessionEvent = 'failure'","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_21"],"transforms":[]}],"outputStreams":["rule_transform_stream_21","rule_notifier_stream_21"],"timestamp":1509031670292},{"id":47,"versionId":44,"topologyId":20,"name":"Failure Events Threshold Detection","description":"Authentication Failure Events Threshold Detection set to 30 seconds","streams":["window_transform_stream_183"],"condition":"SumFailureEvents30s > 5","sql":"SELECT *  FROM window_transform_stream_183 WHERE SumFailureEvents30s > 5","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.NotifierAction","name":"notifierAction","outputStreams":["rule_notifier_stream_47"],"notifierName":"Email Notifier","outputFieldsAndDefaults":{"from":"sam@hortonworks.com","to":"secanhwx@gmail.com","body":"${SessionUser} has just had ${SumFailureEvents30s} authentication failures on host ${shostname}.\nPlease take appropriate action.\n\nThanks,\n\nYour friend Sam","contentType":"text/plain","subject":"Account Penetration Alert for ${SessionUser}"}}],"outputStreams":["rule_transform_stream_47","rule_notifier_stream_47"],"timestamp":1509031670292}],"windows":[{"id":33,"versionId":44,"topologyId":20,"name":"window_auto_generated","description":"window description auto generated","streams":["rule_transform_stream_19"],"window":{"windowLength":{"class":".Window$Duration","durationMs":300000},"slidingInterval":{"class":".Window$Duration","durationMs":300000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_73"],"transforms":[]}],"projections":[{"functionName":"LONGCOUNT","args":["EventId"],"outputFieldName":"SumOpenSessionEvents"},{"expr":"event_month"},{"expr":"event_dow"},{"expr":"event_day"},{"expr":"event_hour"},{"expr":"shostname"},{"expr":"SessionByUser"},{"expr":"SessionUser"}],"groupbykeys":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"],"outputStreams":["window_transform_stream_73","window_notifier_stream_73"],"timestamp":1509031670292},{"id":32,"versionId":44,"topologyId":20,"name":"window_auto_generated","description":"window description auto generated","streams":["rule_transform_stream_20"],"window":{"windowLength":{"class":".Window$Duration","durationMs":300000},"slidingInterval":{"class":".Window$Duration","durationMs":300000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_74"],"transforms":[]}],"projections":[{"functionName":"LONGCOUNT","args":["EventId"],"outputFieldName":"SumClosedSessionEvents"},{"expr":"event_month"},{"expr":"event_dow"},{"expr":"event_day"},{"expr":"event_hour"},{"expr":"shostname"},{"expr":"SessionByUser"},{"expr":"SessionUser"}],"groupbykeys":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"],"outputStreams":["window_transform_stream_74","window_notifier_stream_74"],"timestamp":1509031670292},{"id":34,"versionId":44,"topologyId":20,"name":"window_auto_generated","description":"window description auto generated","streams":["rule_transform_stream_21"],"window":{"windowLength":{"class":".Window$Duration","durationMs":30000},"slidingInterval":{"class":".Window$Duration","durationMs":30000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_183"],"transforms":[]}],"projections":[{"functionName":"LONGCOUNT","args":["EventId"],"outputFieldName":"SumFailureEvents30s"},{"expr":"event_month"},{"expr":"event_dow"},{"expr":"event_day"},{"expr":"event_hour"},{"expr":"shostname"},{"expr":"SessionByUser"},{"expr":"SessionUser"}],"groupbykeys":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"],"outputStreams":["window_transform_stream_183","window_notifier_stream_183"],"timestamp":1509031670292},{"id":31,"versionId":44,"topologyId":20,"name":"window_auto_generated","description":"window description auto generated","streams":["rule_transform_stream_21"],"window":{"windowLength":{"class":".Window$Duration","durationMs":300000},"slidingInterval":{"class":".Window$Duration","durationMs":300000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_75"],"transforms":[]}],"projections":[{"functionName":"LONGCOUNT","args":["EventId"],"outputFieldName":"SumAuthFailureEvents"},{"expr":"event_month"},{"expr":"event_dow"},{"expr":"event_day"},{"expr":"event_hour"},{"expr":"shostname"},{"expr":"SessionByUser"},{"expr":"SessionUser"}],"groupbykeys":["event_month","event_dow","event_day","event_hour","shostname","SessionByUser","SessionUser"],"outputStreams":["window_transform_stream_75","window_notifier_stream_75"],"timestamp":1509031670292}],"branchRules":[],"bundleIdToType":{"1":"KAFKA","12":"NOTIFICATION","4":"RULE","16":"DRUID","5":"WINDOW","8":"PMML","10":"HDFS"},"topologyEditorMetadata":{"topologyId":20,"versionId":44,"data":"{\"sources\":[{\"x\":122.5,\"y\":132.5,\"id\":172}],\"sinks\":[{\"x\":1457.7144775390625,\"y\":84.51812744140625,\"id\":181},{\"x\":1438.3922119140625,\"y\":303.8094177246094,\"id\":180},{\"x\":1120.191162109375,\"y\":321.5690002441406,\"id\":179},{\"x\":445.3184814453125,\"y\":5.05750846862793,\"id\":182},{\"x\":1417.8450927734375,\"y\":423.9778137207031,\"id\":185},{\"x\":1736.8004150390625,\"y\":-46.48142433166504,\"id\":193},{\"x\":1741.35693359375,\"y\":149.44833374023438,\"id\":194},{\"x\":1438.8287353515625,\"y\":231.18064880371094,\"id\":195},{\"x\":1458.8536376953125,\"y\":27.561798095703125,\"id\":196}],\"processors\":[{\"x\":447.5,\"y\":87.5,\"id\":177},{\"x\":448.4542236328125,\"y\":227.24977111816406,\"id\":175},{\"x\":447.303955078125,\"y\":372.1793212890625,\"id\":173},{\"x\":778.625,\"y\":87.0805435180664,\"id\":178},{\"x\":787.1467895507812,\"y\":227.4127197265625,\"id\":176},{\"x\":782.022216796875,\"y\":321.5690002441406,\"id\":174},{\"x\":781.4826049804688,\"y\":423.391845703125,\"id\":183},{\"x\":1119.065185546875,\"y\":423.391845703125,\"id\":184},{\"x\":1453.157958984375,\"y\":-46.48142433166504,\"id\":190},{\"x\":1444.19140625,\"y\":149.55044555664062,\"id\":192},{\"x\":1133.067138671875,\"y\":-27.39653968811035,\"id\":198},{\"x\":1120.595458984375,\"y\":149.55044555664062,\"id\":199}],\"graphTransforms\":{\"dragCoords\":[-229.57606187456054,215.91403339601868],\"zoomScale\":0.8705939533366468},\"customNames\":null}","timestamp":1509031669424}}